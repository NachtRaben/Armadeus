plugins {
    id 'idea'
    id 'java-library'
    id 'application'
    id "com.github.johnrengelman.shadow" version "5.2.0"
}

apply from: "https://nachtraben.com/files/commons.gradle"

group = 'com.nachtraben'
version = ENV

ext {
    nexusUser = System.getenv("NEXUS_USR") ?: loadProperty("nexus.nachtraben.user")
    nexusPass = System.getenv("NEXUS_PSW") ?: loadProperty("nexus.nachtraben.pass")
}

configurations.all {
    resolutionStrategy {
        cacheDynamicVersionsFor 0, 'seconds'
        cacheChangingModulesFor 0, 'seconds'
    }
}

jar {
    baseName = rootProject.name
    mainClassName = 'com.nachtraben.armadeus.Armadeus'
}

sourceCompatibility = targetCompatibility = JavaVersion.VERSION_11
compileJava.options.encoding = javadoc.options.encoding = "UTF-8"

task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    archiveName = project.name + '-sources.jar'
    from project.sourceSets.main.allSource
}

task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    archiveName = rootProject.name + '-javadoc.jar'
    from javadoc.destinationDir
}

repositories {
    maven {
        name = "NachtRaben-Nexus"
        url = "https://nachtraben.com/nexus/repository/maven-public/"
        credentials {
            username = nexusUser
            password = nexusPass

        }
    }
    jcenter()
    maven {
        url 'https://jitpack.io'
    }
    maven { url = 'https://jitpack.io' }
    maven { name = "Kodehawa"; url  "https://dl.bintray.com/kodehawa/maven"}
}

dependencies {
    // Lombok
    compileOnly group: 'org.projectlombok', name: 'lombok', version: '1.18.16'
    annotationProcessor group: 'org.projectlombok', name: 'lombok', version: '1.18.16'

    // Logging
    api group: 'org.slf4j', name: 'slf4j-api', version: '1.7.30'
    implementation group: 'ch.qos.logback', name: 'logback-classic', version: '1.2.3'

    // JDA
    implementation group: 'net.dv8tion', name: 'JDA', version: 'latest.integration', changing: true
    compile group: 'com.github.FredBoat', name: 'Lavalink-Client', version: 'master-SNAPSHOT'

    implementation 'com.github.NachtRaben:OrangeSlice:760b4494a2'
    implementation 'com.github.NachtRaben:LemonSlice:5958b6e659'
    implementation 'com.github.NachtRaben:PineappleSlice:0825a28910'

    // Utility
    implementation group: 'com.mashape.unirest', name: 'unirest-java', version: '1.4.9' // TODO: Phase Out
    implementation group: 'com.vdurmont', name: 'emoji-java', version: '5.1.1' // TODO: Phase Out
    implementation group: 'net.kodehawa', name: 'imageboard-api', version: '2.4.1'
    implementation group: 'org.codehaus.groovy', name: 'groovy-all', version: '3.0.2' // TODO: Phase out/Update
    implementation group: 'org.reflections', name: 'reflections', version: '0.9.12'
    implementation group: 'com.google.guava', name: 'guava', version: '30.0-jre' // TODO: Phase out
    implementation group: 'com.google.code.gson', name: 'gson', version: '2.8.6'

    // Console
    implementation group: 'org.jline', name: 'jline', version: '3.17.1'
    implementation group: 'net.java.dev.jna', name: 'jna', version: '5.6.0'
}
